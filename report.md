# 电影个性化推荐系统设计与实现

## 研究背景

近年来，随着互联网的发展和普及，人们生活水平的提高，人们有更多的时间愿意寻找一些电影来观看。目前互联网上可以获取到大量关于电影的信息，并且类型多样。目前，国内外有很多提供类似服务的网站，例如：IMDB，豆瓣等。电影类型多样，人们只通过浏览很难发现自己感兴趣的电影。而且，随着如今电影发展越来越快，电影数量越来越大，如何让人们在海量的数据中找到自己需要的电影将会越来越难，即是所谓的信息过载问题。

在这样的情形下，搜索引擎（Google，百度等）成为了人们寻找电影的最好途径。假设在人们清晰地知道自己的需求，并能将需求转化为关键字的情况下，人们通过搜索引擎可以很快地找到自己所需要的电影。但是，大多数情况下，人们对于自己想要什么很模糊，并不能准确的将需求转化为关键字。而且，搜索引擎无法提供个性化服务，即相同的关键字对于所有用户返回的信息都是相同的[@高春华2014面向异构社交网络的个性化推荐技术研究]。这时，与搜索引擎对应，一种与搜索引擎不同的技术——推荐引擎便应运而生，其不需要用户提出明确的需求，推荐引擎的出现使得人们获取信息的方式发生了转变，从简单粗暴的关键词匹配转变到了更高级的符合人们生活习惯的更自然的推荐行为。

目前个性化推荐技术在不同应用领域受到工业界和学术界的广泛关注，如何利用如何利用社交网络中丰富的信息向用户推荐更加准确的资源成为当今的研究重点之一，同时如何设计更好的推荐算法也是学术界的重大研究课题之一。

本次研究将基于异构信息网络，顺应发展跟随个性化领域里的新研究方向，将用户和推荐对象抽象成为节点，之间的关系抽象成边，组成为一个网络图。然后通过利用网络分析方法，通过对网络结构的分析给用户做出推荐。提出了一个相似度计算算法HeraSim，以及应用HeraSim的电影推荐算法HeraRec。结合多种类型的数据信息，从而丰富有效数据，缓解稀疏性问题，可以提高推荐的精确度[@曹玖新2016LBSN]。

## 研究的基本内容和拟解决的主要问题

个性化推荐技术主要有基于内容过滤(content-based filtering)[@梁婷婷2017基于内容过滤]的推荐和协同过滤(collaborative filtering)[@崔梓凝2017基于协同过滤的推荐算法研究]推荐技术。但是目前的推荐系统，无论是基于内容过滤的还是协同过滤都存在各种缺陷与不足。

基于内容的过滤，与搜索引擎类似，推荐系统将搜索过程自动化，通过分析用户所喜欢电影的信息，比如演员或者导演等信息，最终给用户推荐据用类似内容的其他电影。这种算法依据历史记录，简单、计算快速。缺点在于特征提取能力有限，难于区分不同语义下的同义词和多义词；推荐过于具体而无法发现新的兴趣资源；并且对于类似电影等难以提取内容的对象无能为力。

协同过滤推荐技术，通过分析所有用户的历史数据，找到和目标用户兴趣相似的一群用户，然后将这群用户所感兴趣的电影推荐给目标用户，即建立用户与电影之间的二元关系，根据用户的历史记录发掘用户潜在兴趣，从而针对用户提供推荐服务。其缺点在于新用户历史数据很少时的冷启动问题；以及用户数量和电影数量的大量增长导致部分用户得不到推荐结果或者部分电影无法被推荐，即容易遭受数据稀疏性影响。

用户量之庞大、节点的异质性、连接的复杂性以及数据的稀疏让等问题给网络用户行为分析及个性化推荐带来了更大的挑战[@杨家红2017引入一种基于元路径的链路预测机制的好友推荐算法]。

基于以上考虑，本研究将提出一种基于异构社交网络和元路径的电影个性化推荐算法。本文通过把社交网络中的用户，电影以及电影的标签特征信息转化为网络中相应的节点，同时把用户与电影之间的观看关系，用户与用户之间的关注关系以及电影与标签之间的标注关系转化为相应节点之间的边，构造出一个具有多种节点类型的异构信息网络。该推荐算法试图通过利用异构网络中的信息以及元路径，有效解决数据稀疏、冷启动等问题，进而提升推荐系统的性能。

利用社交网络中不同路径下的语义信息可以用于提高相似度测量的准确性，进而提升推荐系统的推荐质量。目前，学术界提出了一些基于异构社交网络的相似度测量方法。PathSim[@Sun2011PathSim]定义了元路径的概念，开启了利用不同路径语义来解释推荐理由的先河，但它只适用于对称路径的相同类型对象的相似测量。对于推荐系统而言，需要的相似度测量很大部分都是非对称路径上的非同类对象的相似度测量，因此PathSim无法适用。对此，Shi等人提出了HeteSim[@Shi2014HeteSim]，引入了双向随机游走模型，通过计算在中间节点相遇的概率来测量非对称路径下不同类型对象间的相似度，但是其只考虑了在同一个位置的相似度，实际上，同一路径的不同位置也蕴含着不同的语义信息。对此高春华等人提出了HybSim[@高春华2014面向异构社交网络的个性化推荐技术研究]，其充分地利用了路径内不同相遇位置的信息，对于路径内的所有位置都予以考虑。

值得注意的是，现有基于路径语义的相似度测量方法都没有考虑网络中边的权值，默认将所有的连接都看作同等的。然而在本研究中的电影推荐系统，用户对于电影的评分不可忽视。为此，本次研究将对于上述算法进行改进，提出一个相似度测量算法，该方法将网络连接的权值考虑进去，进而利用路径内权值的语义，提升相似度测量的精度。

最终，本研究将采用MovieLens数据库中的数据进行试验，使用Python编写脚本程序，做出大量试验样本与结果，使用几种主流的衡量算法性能的指标，并与主流的几种推荐算法进行对比，来验证本次研究推荐算法的有效性。

## 研究方法及措施

### 异构信息网络

异构网络是指存在不同性质节点的网络，指的是网络中节点对象类型及关系类型有许多种类，对于节点类型和关系类型而言，至少应存在两种[@田鹏伟2017异构信息网络融合方法研究综述]。一般定义为四元组 $G=(V, E, A ,R)$，其中$V$ 是节点集合，$E$是边的集合，$A$是节点类型集合，$R$ 是边的类型的集合。其中每个节点$v\in V$ 都代表了一个特定的对象，且对应于一个特定的节点类型$a\in A$ ; 每个边$e\in E$ 都代表着一种特殊的关系，且对应于一个特定的关系类型$r\in R$ 。当节点类型的数量$|A|\gt 1$ 或者边类型的数量$|R|\gt 1$ ，则称该网络为异构信息网络。

对于本研究来说，该网络包含若干种不同的对象类型：用户，电影，标签等。

### 元路径

元路径(meta-path)主要用来描述异构网络中任意两节点间的不同路径类型。一般定义为一条在网络模型$G_T=(A, R)$ 中的路径，表示为$A_0 \xrightarrow {R_0} A_1 \xrightarrow {R_1}\dots\xrightarrow {R_{l-1}} A_l  $ ，其中$A_0, A_1, \dots, A_l \in A$ ，$R_0, R_1, \dots, R_{l-1} \in R$ 。为了简化元路径的表示，可以省略节点之间的关系直接用节点类型的名字来表示元路径，例如上述元路径可以表示为$A_0 \rightarrow A_1 \rightarrow \dots \rightarrow A_l$ ，或者$A_0A_1\dots A_l$ 。当在异构网络中存在一条具体的路径$p=(a_0a_1\dots a_l)$ ，则称其为元路径$P=(A_0A_1\dots A_l)$ 的一个路径实例。

### HeraSim

基于异步双向随机游走模型，本次研究提出了在元路径上两个对象间的相似度测量方法HeraSim如下定义：

对于一个给定的元路径$P=A_0A_1\ldots A_l$，假设对象$u$和$v$相遇在某个节点$m$，其中$\phi(u)=A_0$, $\phi(v)=A_l$,$\phi(m)=A_i$，则有：

$HeraSim(u,v|P_{A_0A_1\ldots A_l},A_i)=\sum\limits_{m\in A_i}Prob(u,m|P_{A_0A_1\ldots A_i})Prob(v,m|P^{-1}_{A_iA_{i+1}\ldots A_l})$ 

(3.1)

其中，

$Prob(u,m|P_{A_0A_1\ldots A_i})=\begin{cases}\frac{1}{|O(u|A_0A_1)|*\sum{w_{u'}}} \sum\limits_{u'\in O(u|A_0A_1)}w_{u'}*Prob(u',m|P_{A_1A_2\ldots A_i}) & \phi(u)\neq \phi(m) \\ 1 & \phi(u)= \phi(m) \and u=m \\ 0 &  \phi(u)= \phi(m) \and u\neq m\end{cases}$

(3.2)

$Prob(v,m|P^{-1}_{A_iA_{l-1}\ldots A_l})=\begin{cases}\frac{1}{|I(v|A_{l-1}A_l)|*\sum{w_{v'}}} \sum\limits_{v'\in I(v|A_{l-1}A_l)}w_{v'}*Prob(v',m|P^{-1}_{A_iA_{l-2}\ldots A_{l-1}})& \phi(v)\neq \phi(m) \\ 1 & \phi(v)= \phi(m) \and v=m \\ 0 &  \phi(v)= \phi(m) \and v\neq m\end{cases}$

(3.3)

公式(3.2)和(3.3)中的$Prob(u,m|P_{A_0A_1\ldots A_i})$ 和 $Prob(v,m|P^{-1}_{A_iA_{l-1}\ldots A_l})$ 分别是沿着元路径$P$从$u$到$m$的前向随机游走的可到达率和沿着反向元路径$P^{-1}$从$v$到$m$的后向随机游走的可到达率，这个可到达率考虑了不同邻居的权值。$O$和$I$集合分别表示出度邻居集合和入度邻居集合，当$|O|$或者$|I|$为0时，定义$Prob=0$. 

这时，可以理解公式(3.1)意为$u$和$v$的HeraSim值为，$u$和$v$各自从元路径的两端进行随机游走最终它们相遇的概率值。

最后通过把元路径上的所有位置的HeraSim值求算术平均值，即为最终的HeraSim相似度。

### HeraRec

将HeraSim算法应用在推荐系统上，假设我们现在使用了$L$条元路径，那么使用HeraSim我们将得到$L$个相似度矩阵，$S_1,S_2,\ldots ,S_L$。不同的元路径对于推荐来说有不同的重要程度，因此我们为每一条元路径设定一个权值$\theta_i$，综合得到HeraRec的公式为：

$HeraSim(U,V)=\sum\limits^L_{i=1} S_i\theta_i$

至此我们得到了从$U$到$V$的推荐度，将其排序得到top-k。



## 步骤与进度

1. 2018年1月，寒假开始前，进行文献搜集工作，了解该题目的具体要求。
2. 2018年2月，寒假结束之前，完成相关文献的阅读与分析，并进行代码的初步编写。
3. 2018年3月，完成代码基本功能的实现，并起草论文。
4. 2018年4月中旬，在中期答辩之前，完成代码的开发与测试，论文框架已成型。
5. 2018年5月，在中期答辩之后1个月，根据中期提出的问题进行修改，完成论文写作，论文查重，符合参加毕业答辩的要求。

## 参考文献

